#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Get current branch name
branch=$(git symbolic-ref --short HEAD)

# Define valid branch name pattern
valid_branch_regex="^(main|develop|feature|fix|test|chore|ci|docs|refactor|perf|build|revert)\/[a-z0-9._-]+$|^(main|develop)$"

# Check if branch name matches pattern
if ! echo "$branch" | grep -qE "$valid_branch_regex"; then
    echo "❌ Invalid branch name: $branch"
    echo ""
    echo "Branch names must follow this pattern:"
    echo "  - feature/your-feature-name"
    echo "  - fix/bug-description"
    echo "  - test/test-description"
    echo "  - chore/task-description"
    echo "  - ci/ci-changes"
    echo "  - docs/documentation-changes"
    echo "  - main or develop (protected branches)"
    echo ""
    echo "Use lowercase, hyphens, dots, or underscores only."
    exit 1
fi

echo "✅ Branch name is valid: $branch"
